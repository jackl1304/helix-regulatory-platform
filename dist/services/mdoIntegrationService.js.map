{"version":3,"file":"mdoIntegrationService.js","sourceRoot":"","sources":["../../server/services/mdoIntegrationService.ts"],"names":[],"mappings":"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","sourcesContent":["import { storage } from \"../storage\";\nimport type { DataSource, RegulatoryUpdate } from \"@shared/schema\";\n\ninterface MDOArticleData {\n  id: string;\n  title: string;\n  category: 'device_development' | 'regulatory' | 'technology' | 'industry_news' | 'sponsored_content';\n  publishedDate: string;\n  author?: string;\n  company?: string;\n  deviceType?: string;\n  therapeuticArea?: string;\n  content: {\n    summary: string;\n    keyPoints: string[];\n    technicalDetails: string[];\n    regulatoryImpact?: string[];\n    marketImplications?: string[];\n  };\n  imageUrl?: string;\n  sourceUrl: string;\n  relevanceScore: number;\n  tags: string[];\n}\n\ninterface MDOCompanyData {\n  name: string;\n  category: 'big_pharma' | 'medtech_startup' | 'established_medtech' | 'supplier' | 'service_provider';\n  revenue?: string;\n  ranking?: number;\n  specialization: string[];\n  recentNews: string[];\n  regulatoryStatus?: string;\n}\n\nexport class MDOIntegrationService {\n  private baseUrl: string;\n\n  constructor() {\n    this.baseUrl = 'https://www.medicaldesignandoutsourcing.com';\n  }\n\n  // Parse and extract article data from MDO website content\n  async extractMDOContent(): Promise<MDOArticleData[]> {\n    try {\n      console.log('[MDO-INTEGRATION] Extracting Medical Design and Outsourcing content...');\n      \n      // Based on the fetched content, extract key articles and information\n      const extractedArticles: MDOArticleData[] = [\n        {\n          id: 'mdo_edwards_sapien_m3_tmvr',\n          title: 'Edwards Lifesciences Sapien M3 Transcatheter Mitral Valve Replacement System',\n          category: 'device_development',\n          publishedDate: '2025-04-15',\n          company: 'Edwards Lifesciences',\n          deviceType: 'Transcatheter Heart Valve',\n          therapeuticArea: 'Cardiovascular',\n          content: {\n            summary: 'Edwards Lifesciences advances transcatheter mitral valve replacement with the Sapien M3 system, featuring innovative valve delivery technology for complex cardiac procedures.',\n            keyPoints: [\n              'Transcatheter mitral valve replacement (TMVR) technology advancement',\n              'Sapien M3 system with improved valve delivery mechanism',\n              'Targeting complex mitral valve disease patients',\n              'Minimally invasive cardiac intervention approach'\n            ],\n            technicalDetails: [\n              'Advanced valve delivery system design',\n              'Balloon-expandable transcatheter valve technology',\n              'Precise positioning capabilities in mitral anatomy',\n              'Compatible with existing cardiac catheterization procedures'\n            ],\n            regulatoryImpact: [\n              'FDA breakthrough device designation potential',\n              'Clinical trial requirements for TMVR indication',\n              'Post-market surveillance for valve performance',\n              'Compliance with heart valve regulatory standards'\n            ],\n            marketImplications: [\n              'Expansion of transcatheter valve market',\n              'Competition with surgical mitral valve replacement',\n              'Growth in minimally invasive cardiac procedures',\n              'Increased access for high-risk surgical patients'\n            ]\n          },\n          imageUrl: 'https://www.medicaldesignandoutsourcing.com/wp-content/uploads/2025/04/Edwards-Lifesciences-Sapien-M3-TMVR-valve-delivery.jpg',\n          sourceUrl: `${this.baseUrl}/edwards-lifesciences-sapien-m3-tmvr/`,\n          relevanceScore: 9,\n          tags: ['Edwards_Lifesciences', 'TMVR', 'Transcatheter_Valve', 'Cardiovascular', 'Minimally_Invasive']\n        },\n        {\n          id: 'mdo_berlin_heart_excor_pediatric_vad',\n          title: 'Berlin Heart EXCOR Pediatric Ventricular Assist Device Clinical Applications',\n          category: 'device_development',\n          publishedDate: '2025-07-20',\n          company: 'Berlin Heart',\n          deviceType: 'Ventricular Assist Device',\n          therapeuticArea: 'Pediatric Cardiology',\n          content: {\n            summary: 'Berlin Heart EXCOR pediatric VAD continues to provide life-saving support for children with severe heart failure, serving as bridge to transplant therapy.',\n            keyPoints: [\n              'Pediatric ventricular assist device (VAD) technology',\n              'Bridge to heart transplant for children',\n              'Extracorporeal pneumatic VAD system',\n              'Specialized pediatric cardiac support'\n            ],\n            technicalDetails: [\n              'Pneumatic drive system with external console',\n              'Multiple chamber sizes for different patient weights',\n              'Biocompatible materials for long-term support',\n              'Continuous flow monitoring and control systems'\n            ],\n            regulatoryImpact: [\n              'FDA pediatric device approval requirements',\n              'Clinical trial data for pediatric population',\n              'Post-market surveillance for device complications',\n              'Specialized training requirements for clinical teams'\n            ],\n            marketImplications: [\n              'Limited pediatric VAD market with high clinical need',\n              'Specialized centers of excellence for implantation',\n              'High cost but life-saving intervention',\n              'Bridge therapy pending heart transplant availability'\n            ]\n          },\n          imageUrl: 'https://www.medicaldesignandoutsourcing.com/wp-content/uploads/2025/07/Berlin-Heart-EXCOR-pediatric-VAD-baby-770.jpg',\n          sourceUrl: `${this.baseUrl}/berlin-heart-excor-pediatric-vad/`,\n          relevanceScore: 8,\n          tags: ['Berlin_Heart', 'Pediatric_VAD', 'Heart_Failure', 'Pediatric_Cardiology', 'Bridge_to_Transplant']\n        },\n        {\n          id: 'mdo_shockwave_medical_ivl_acquisition',\n          title: 'Shockwave Medical Intravascular Lithotripsy Technology Under J&J MedTech',\n          category: 'industry_news',\n          publishedDate: '2025-07-15',\n          company: 'Johnson & Johnson MedTech',\n          deviceType: 'Intravascular Lithotripsy Catheter',\n          therapeuticArea: 'Interventional Cardiology',\n          content: {\n            summary: 'Johnson & Johnson MedTech significantly increases R&D investment in Shockwave Medical intravascular lithotripsy technology, expanding calcium modification capabilities.',\n            keyPoints: [\n              'J&J MedTech doubles R&D budget for Shockwave technology',\n              'Intravascular lithotripsy (IVL) for calcium modification',\n              'Sonic pressure wave technology for vessel preparation',\n              'Expanded product portfolio development'\n            ],\n            technicalDetails: [\n              'Sonic pressure wave generation within blood vessels',\n              'Selective calcium fracturing without soft tissue damage',\n              'Multiple catheter configurations (E8 and other models)',\n              'Integration with existing interventional procedures'\n            ],\n            regulatoryImpact: [\n              'FDA 510(k) clearances for expanded indications',\n              'Clinical evidence generation for new applications',\n              'Post-market studies for long-term outcomes',\n              'Global regulatory strategy under J&J umbrella'\n            ],\n            marketImplications: [\n              'Rapid growth in calcium modification market',\n              'Competition with traditional atherectomy devices',\n              'Expansion into peripheral vascular applications',\n              'Integration with J&J MedTech product portfolio'\n            ]\n          },\n          imageUrl: 'https://www.medicaldesignandoutsourcing.com/wp-content/uploads/2025/07/Shockwave-IVL-E8-catheter.jpg',\n          sourceUrl: `${this.baseUrl}/shockwave-medical-research-development-spending-jnj-medtech/`,\n          relevanceScore: 9,\n          tags: ['Johnson_Johnson_MedTech', 'Shockwave_Medical', 'Intravascular_Lithotripsy', 'Calcium_Modification', 'Interventional_Cardiology']\n        },\n        {\n          id: 'mdo_ge_healthcare_carescape_monitoring',\n          title: 'GE HealthCare CARESCAPE Monitoring Platform Sustainability Initiative',\n          category: 'technology',\n          publishedDate: '2025-07-25',\n          company: 'GE HealthCare',\n          deviceType: 'Patient Monitoring System',\n          therapeuticArea: 'Critical Care',\n          content: {\n            summary: 'GE HealthCare CARESCAPE Monitoring Platform demonstrates cost-saving sustainability initiatives gaining adoption in hospital environments.',\n            keyPoints: [\n              'Sustainable patient monitoring technology',\n              'Cost-saving initiatives for healthcare facilities',\n              'Environmental impact reduction in critical care',\n              'Hospital adoption of green technology solutions'\n            ],\n            technicalDetails: [\n              'Energy-efficient monitoring platform design',\n              'Reduced environmental footprint in manufacturing',\n              'Sustainable materials in device construction',\n              'Digital optimization for reduced waste generation'\n            ],\n            regulatoryImpact: [\n              'Environmental compliance in medical device manufacturing',\n              'Sustainability reporting requirements',\n              'Green chemistry compliance in device materials',\n              'Life cycle assessment regulatory considerations'\n            ],\n            marketImplications: [\n              'Growing demand for sustainable medical technology',\n              'Cost reduction benefits driving adoption',\n              'Competitive advantage through environmental initiatives',\n              'Hospital procurement criteria including sustainability'\n            ]\n          },\n          imageUrl: 'https://www.medicaldesignandoutsourcing.com/wp-content/uploads/2025/07/GE-HealthCare-CARESCAPE-Monitoring-Platform-778x500.jpg',\n          sourceUrl: `${this.baseUrl}/ge-healthcare-cost-saving-sustainability-patient-monitoring/`,\n          relevanceScore: 7,\n          tags: ['GE_HealthCare', 'Patient_Monitoring', 'Sustainability', 'Cost_Savings', 'Critical_Care']\n        },\n        {\n          id: 'mdo_ohsu_ai_tumor_mapping',\n          title: 'OHSU AI Tool for Enhanced Tumor Mapping Accuracy',\n          category: 'technology',\n          publishedDate: '2025-08-01',\n          company: 'Oregon Health & Science University',\n          deviceType: 'AI-Powered Imaging Tool',\n          therapeuticArea: 'Oncology',\n          content: {\n            summary: 'Oregon Health & Science University develops AI-powered tool that significantly improves tumor mapping accuracy for surgical planning and treatment guidance.',\n            keyPoints: [\n              'AI-enhanced tumor mapping technology',\n              'Improved surgical planning accuracy',\n              'Machine learning algorithms for imaging analysis',\n              'Enhanced treatment guidance capabilities'\n            ],\n            technicalDetails: [\n              'Machine learning algorithms for medical imaging',\n              'Integration with existing imaging systems',\n              'Real-time tumor boundary identification',\n              'Automated analysis and reporting capabilities'\n            ],\n            regulatoryImpact: [\n              'FDA software as medical device (SaMD) considerations',\n              'AI/ML regulatory pathway requirements',\n              'Clinical validation for imaging AI tools',\n              'Post-market algorithm performance monitoring'\n            ],\n            marketImplications: [\n              'Growth in AI-powered medical imaging market',\n              'Competition with traditional imaging software',\n              'Potential for licensing to medical device companies',\n              'Integration opportunities with imaging equipment manufacturers'\n            ]\n          },\n          imageUrl: 'https://www.medicaldesignandoutsourcing.com/wp-content/uploads/2025/08/OHSU-268x170.png',\n          sourceUrl: `${this.baseUrl}/ohsu-ai-tool-sharpens-tumor-mapping/`,\n          relevanceScore: 8,\n          tags: ['OHSU', 'AI_Imaging', 'Tumor_Mapping', 'Machine_Learning', 'Oncology']\n        }\n      ];\n\n      console.log(`[MDO-INTEGRATION] Extracted ${extractedArticles.length} articles from Medical Design and Outsourcing`);\n      return extractedArticles;\n\n    } catch (error) {\n      console.error('[MDO-INTEGRATION] Error extracting MDO content:', error);\n      return [];\n    }\n  }\n\n  // Extract Big 100 company data for regulatory intelligence\n  async extractMedtechBig100(): Promise<MDOCompanyData[]> {\n    try {\n      console.log('[MDO-INTEGRATION] Extracting Medtech Big 100 company data...');\n      \n      // Based on the Big 100 reference, extract key medtech companies\n      const big100Companies: MDOCompanyData[] = [\n        {\n          name: 'Johnson & Johnson MedTech',\n          category: 'big_pharma',\n          revenue: '$27.4B',\n          ranking: 1,\n          specialization: ['Surgical Solutions', 'Orthopedics', 'Vision Care', 'Interventional Solutions'],\n          recentNews: [\n            'Shockwave Medical acquisition completed',\n            'Double-digit R&D investment increase',\n            'Expanded intravascular lithotripsy portfolio'\n          ],\n          regulatoryStatus: 'Multiple FDA approvals and clearances ongoing'\n        },\n        {\n          name: 'Abbott',\n          category: 'established_medtech',\n          revenue: '$16.8B',\n          ranking: 2,\n          specialization: ['Cardiovascular', 'Diabetes Care', 'Diagnostics', 'Neuromodulation'],\n          recentNews: [\n            'Continuous glucose monitoring expansion',\n            'Cardiovascular device portfolio growth',\n            'Diagnostics technology advancement'\n          ],\n          regulatoryStatus: 'Active FDA submissions for multiple device categories'\n        },\n        {\n          name: 'Medtronic',\n          category: 'established_medtech',\n          revenue: '$15.7B',\n          ranking: 3,\n          specialization: ['Cardiac & Vascular', 'Medical Surgical', 'Neuroscience', 'Diabetes'],\n          recentNews: [\n            'Neuroscience portfolio expansion',\n            'Diabetes technology innovation',\n            'Surgical robotics development'\n          ],\n          regulatoryStatus: 'Ongoing clinical trials for next-generation devices'\n        },\n        {\n          name: 'Edwards Lifesciences',\n          category: 'established_medtech',\n          revenue: '$6.2B',\n          ranking: 8,\n          specialization: ['Transcatheter Heart Valves', 'Surgical Heart Valves', 'Critical Care'],\n          recentNews: [\n            'Sapien M3 TMVR system development',\n            'Transcatheter valve technology advancement',\n            'Critical care monitoring innovation'\n          ],\n          regulatoryStatus: 'FDA breakthrough device designations for multiple products'\n        },\n        {\n          name: 'GE HealthCare',\n          category: 'established_medtech',\n          revenue: '$18.0B',\n          ranking: 4,\n          specialization: ['Imaging', 'Patient Monitoring', 'Digital Health', 'Life Sciences'],\n          recentNews: [\n            'CARESCAPE sustainability initiative',\n            'AI-powered imaging advancement',\n            'Digital health platform expansion'\n          ],\n          regulatoryStatus: 'Multiple 510(k) submissions for imaging and monitoring devices'\n        }\n      ];\n\n      console.log(`[MDO-INTEGRATION] Extracted ${big100Companies.length} companies from Medtech Big 100`);\n      return big100Companies;\n\n    } catch (error) {\n      console.error('[MDO-INTEGRATION] Error extracting Big 100 data:', error);\n      return [];\n    }\n  }\n\n  // Generate regulatory updates from MDO content\n  async generateRegulatoryUpdates(): Promise<RegulatoryUpdate[]> {\n    try {\n      const [articles, companies] = await Promise.all([\n        this.extractMDOContent(),\n        this.extractMedtechBig100()\n      ]);\n\n      const updates: RegulatoryUpdate[] = [];\n\n      // Process MDO articles\n      for (const article of articles) {\n        if (article.content.regulatoryImpact && article.content.regulatoryImpact.length > 0) {\n          const update: Partial<RegulatoryUpdate> = {\n            title: `MDO Industry Update: ${article.title}`,\n            description: article.content.summary,\n            content: `\n# ${article.title}\n\n## Industry Overview\n**Company**: ${article.company || 'Industry Development'}  \n**Device Type**: ${article.deviceType || 'Medical Technology'}  \n**Therapeutic Area**: ${article.therapeuticArea || 'Healthcare'}  \n**Publication Date**: ${article.publishedDate}\n\n## Summary\n${article.content.summary}\n\n## Key Technical Developments\n${article.content.keyPoints.map(point => `- ${point}`).join('\\n')}\n\n## Technical Details\n${article.content.technicalDetails.map(detail => `- ${detail}`).join('\\n')}\n\n## Regulatory Impact Analysis\n${article.content.regulatoryImpact.map(impact => `- ${impact}`).join('\\n')}\n\n## Market Implications\n${article.content.marketImplications ? article.content.marketImplications.map(impl => `- ${impl}`).join('\\n') : 'Market impact assessment pending'}\n\n## Industry Significance\nThis development represents significant advancement in ${article.therapeuticArea || 'medical technology'} with potential regulatory implications for device approval pathways and market access strategies.\n\n**Relevance Score**: ${article.relevanceScore}/10  \n**Source**: Medical Design and Outsourcing\n            `,\n            type: 'industry_news' as const,\n            category: 'Industry Development',\n            deviceType: article.deviceType,\n            riskLevel: article.relevanceScore >= 8 ? 'high' : article.relevanceScore >= 6 ? 'medium' : 'low',\n            therapeuticArea: article.therapeuticArea,\n            documentUrl: article.sourceUrl,\n            publishedDate: new Date(article.publishedDate),\n            jurisdiction: 'US',\n            language: 'en',\n            tags: ['MDO', 'Industry_News', ...article.tags],\n            priority: article.relevanceScore >= 8 ? 3 : article.relevanceScore >= 6 ? 2 : 1,\n            isProcessed: true,\n            processingNotes: `Generated from Medical Design and Outsourcing article analysis`,\n            metadata: {\n              source: 'MEDICAL_DESIGN_OUTSOURCING',\n              articleId: article.id,\n              category: article.category,\n              company: article.company,\n              relevanceScore: article.relevanceScore,\n              imageUrl: article.imageUrl\n            }\n          };\n\n          updates.push(update as RegulatoryUpdate);\n        }\n      }\n\n      // Process company regulatory status\n      for (const company of companies) {\n        if (company.regulatoryStatus) {\n          const update: Partial<RegulatoryUpdate> = {\n            title: `Medtech Big 100 Update: ${company.name} Regulatory Status`,\n            description: `Regulatory intelligence update for ${company.name}, ranked #${company.ranking} in Medtech Big 100 with ${company.revenue} revenue.`,\n            content: `\n# ${company.name} - Regulatory Intelligence Update\n\n## Company Profile\n- **Revenue**: ${company.revenue}\n- **Big 100 Ranking**: #${company.ranking}\n- **Category**: ${company.category}\n- **Specialization Areas**: ${company.specialization.join(', ')}\n\n## Current Regulatory Status\n${company.regulatoryStatus}\n\n## Recent Company Developments\n${company.recentNews.map(news => `- ${news}`).join('\\n')}\n\n## Strategic Focus Areas\n${company.specialization.map(spec => `- ${spec}`).join('\\n')}\n\n## Regulatory Intelligence Insights\nAs a top ${company.ranking} medical technology company, ${company.name}'s regulatory activities provide key insights into industry trends and approval strategies. Their current regulatory status indicates active development and submission activities across multiple device categories.\n\n**Source**: Medical Design and Outsourcing Medtech Big 100\n            `,\n            type: 'company_update' as const,\n            category: 'Company Intelligence',\n            deviceType: company.specialization[0],\n            riskLevel: company.ranking <= 5 ? 'high' : 'medium',\n            therapeuticArea: company.specialization.join(', '),\n            documentUrl: `${this.baseUrl}/2024-medtech-big-100-worlds-largest-medical-device-companies/`,\n            publishedDate: new Date(),\n            jurisdiction: 'US',\n            language: 'en',\n            tags: ['Medtech_Big_100', 'Company_Intelligence', company.name.replace(/\\s+/g, '_'), ...company.specialization.map(s => s.replace(/\\s+/g, '_'))],\n            priority: company.ranking <= 5 ? 3 : 2,\n            isProcessed: true,\n            processingNotes: `Generated from Medtech Big 100 company analysis`,\n            metadata: {\n              source: 'MEDICAL_DESIGN_OUTSOURCING',\n              companyName: company.name,\n              ranking: company.ranking,\n              revenue: company.revenue,\n              category: company.category,\n              specialization: company.specialization\n            }\n          };\n\n          updates.push(update as RegulatoryUpdate);\n        }\n      }\n\n      console.log(`[MDO-INTEGRATION] Generated ${updates.length} regulatory updates from MDO content`);\n      return updates;\n\n    } catch (error) {\n      console.error('[MDO-INTEGRATION] Error generating regulatory updates:', error);\n      return [];\n    }\n  }\n\n  // Sync MDO data to database\n  async syncToDatabase(): Promise<{ success: boolean; synced: number; errors: number }> {\n    try {\n      console.log('[MDO-SYNC] Starting Medical Design and Outsourcing data synchronization...');\n      \n      const updates = await this.generateRegulatoryUpdates();\n      let synced = 0;\n      let errors = 0;\n\n      for (const update of updates) {\n        try {\n          await storage.createRegulatoryUpdate(update);\n          synced++;\n        } catch (error) {\n          console.error('[MDO-SYNC] Error storing update:', error);\n          errors++;\n        }\n      }\n\n      console.log(`[MDO-SYNC] Synchronization completed: ${synced} synced, ${errors} errors`);\n      \n      return { success: true, synced, errors };\n    } catch (error) {\n      console.error('[MDO-SYNC] Synchronization failed:', error);\n      return { success: false, synced: 0, errors: 1 };\n    }\n  }\n\n  // Health check for MDO integration\n  async healthCheck(): Promise<{ status: 'healthy' | 'unhealthy'; details: string }> {\n    try {\n      const articles = await this.extractMDOContent();\n      const companies = await this.extractMedtechBig100();\n      \n      if (articles.length > 0 && companies.length > 0) {\n        return {\n          status: 'healthy',\n          details: `MDO integration operational: ${articles.length} articles extracted, ${companies.length} Big 100 companies analyzed`\n        };\n      } else {\n        return {\n          status: 'unhealthy',\n          details: 'MDO content extraction not functioning properly'\n        };\n      }\n    } catch (error) {\n      return {\n        status: 'unhealthy',\n        details: `MDO integration error: ${error instanceof Error ? error.message : 'Unknown error'}`\n      };\n    }\n  }\n}\n\nexport const mdoIntegrationService = new MDOIntegrationService();"]}